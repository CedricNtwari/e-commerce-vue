import{d as f,o as i,c as d,a as o,n as L,t as p,_ as v,r as T,w as k,F as g,b as y,e as h,i as I,f as C,g as q,h as j,j as b,k as _,C as x,l as F,T as R,m as $,p as A,q as M,s as B}from"./index-BWRKgXBR.js";const D={class:"product d-flex flex-column"},E={class:"p-10 d-flex flex-column"},N={class:"d-flex flex-row align-items-center"},V={class:"flex-fill"},z=f({__name:"ShopProduct",props:{product:{}},emits:["addProductToCart"],setup(u,{emit:t}){const r=t;return(l,n)=>(i(),d("div",D,[o("div",{class:"product-image",style:L({backgroundImage:l.product.image?`url(${l.product.image})`:"url(https://media.ldlc.com/r1600/ld/products/00/05/82/01/LD0005820198_1.jpg)"})},null,4),o("div",E,[o("h4",null,p(l.product.title),1),o("p",null,p(l.product.description)+"1",1),o("div",N,[o("strong",V,p(l.product.price)+"€",1),o("button",{class:"btn btn-primary",onClick:n[0]||(n[0]=e=>r("addProductToCart",l.product._id))}," Add to Cart ")])])]))}}),K=v(z,[["__scopeId","data-v-86854be3"]]),w=Symbol(),W={class:"grid mb-20"},G={key:0,class:"d-flex flex-row align-items-center justify-content-center"},H=f({__name:"ShopProductList",props:{products:{},moreResults:{type:Boolean}},emits:["addProductToCart","loadMore"],setup(u,{emit:t}){const r=I(w),l=T(null),n=t;return k(r,()=>{var e;r.value===1&&((e=l.value)==null||e.scroll(0,0))}),(e,a)=>(i(),d("div",{ref_key:"scrollableDiv",ref:l,class:"d-flex flex-column p-20"},[o("div",W,[(i(!0),d(g,null,y(e.products,s=>(i(),C(K,{onAddProductToCart:a[0]||(a[0]=c=>n("addProductToCart",c)),product:s,key:s._id},null,8,["product"]))),128))]),e.moreResults&&e.products.length?(i(),d("div",G,[o("button",{onClick:a[1]||(a[1]=s=>n("loadMore")),class:"btn btn-primary"}," Load more ")])):h("",!0)],512))}}),J=v(H,[["__scopeId","data-v-4c33a99a"]]),O={class:"p-20 d-flex flex-column"},Q={class:"mb-20"},X=["value"],Y={class:"mb-20"},Z=["id","checked","onInput"],U=["for"],tt={class:"mb-20 flex-fill"},et=["onClick"],st={class:"mb-10"},ot=f({__name:"ShopFilters",props:{filters:{},productResults:{}},emits:["updateFilter"],setup(u,{emit:t}){const r=t;return(l,n)=>(i(),d("div",O,[o("section",Q,[n[2]||(n[2]=o("h3",{class:"mb-10"},"Search",-1)),o("input",{value:l.filters.search,onInput:n[0]||(n[0]=e=>r("updateFilter",{search:e.target.value})),type:"text",placeholder:"Search..."},null,40,X)]),o("section",Y,[n[3]||(n[3]=o("h3",{class:"mb-10"},"Sort by price",-1)),(i(),d(g,null,y([[0,1e4],[800,1e3],[1e3,1500],[1500,2e3],[2e3,1e4]],e=>o("div",{class:"mb-5",key:e+""},[o("input",{type:"radio",name:"priceRange",id:e[0]+"",checked:l.filters.priceRange[0]===e[0]&&l.filters.priceRange[1]===e[1],onInput:a=>r("updateFilter",{priceRange:e})},null,40,Z),o("label",{for:e[0].toString()},p(e[0]===0?"All price":e[0]===2e3?"More than 2000€":`${e[0]}€ - ${e[1]}€`),9,U)])),64))]),o("section",tt,[n[4]||(n[4]=o("h3",{class:"mb-10"},"Sort by category",-1)),(i(),d(g,null,y(["all","desktop","gamer","streaming"],e=>o("p",{class:q(["category",{selected:l.filters.category===e}]),key:e,onClick:a=>r("updateFilter",{category:e})},p(e),11,et)),64))]),o("small",st,[o("strong",null,p(l.productResults),1),n[5]||(n[5]=j(" Results"))]),o("button",{class:"btn btn-danger",onClick:n[1]||(n[1]=e=>r("updateFilter",{}))}," Clear filters ")]))}}),rt=v(ot,[["__scopeId","data-v-5871c789"]]),nt={class:"d-flex flex-row shop-container"},lt={class:"d-flex flex-column"},at=f({__name:"Shop",props:{products:{},filters:{},moreResults:{type:Boolean}},emits:["addProductToCart","updateFilter","incPage"],setup(u,{emit:t}){const r=b({open:!matchMedia("(max-width: 575px)").matches,isMobile:matchMedia("(max-width: 575px)").matches}),l=t;return(n,e)=>(i(),d("div",nt,[_(x,{open:r.isMobile&&r.open,onClose:e[0]||(e[0]=a=>r.open=!1),transparent:!0},null,8,["open"]),_(R,null,{default:F(()=>[r.open?(i(),C(rt,{key:0,filters:n.filters,productResults:n.products.length,onUpdateFilter:e[1]||(e[1]=a=>l("updateFilter",a)),class:"shop-filter"},null,8,["filters","productResults"])):h("",!0)]),_:1}),o("div",lt,[o("button",{onClick:e[2]||(e[2]=a=>r.open=!r.open),class:"btn btn-primary d-flex flex-row justify-content-center align-items-center"},e[5]||(e[5]=[o("i",{class:"fa-solid fa-magnifying-glass mr-10"},null,-1),o("span",null,"Rechercher",-1)])),_(J,{class:"flex-fill scrollable",onAddProductToCart:e[3]||(e[3]=a=>l("addProductToCart",a)),onIncPage:e[4]||(e[4]=a=>l("incPage")),products:n.products,"more-results":n.moreResults},null,8,["products","more-results"])])]))}}),it=v(at,[["__scopeId","data-v-d6e41fcd"]]),ct={class:"mb-10 p-10 d-flex flex-row align-items-center product"},dt={class:"mr-10"},ut={class:"flex-fill mr-10"},pt={class:"mr-10"},mt=f({__name:"CartProduct",props:{product:{}},emits:["removeProductFromCart"],setup(u,{emit:t}){const r=t;return(l,n)=>(i(),d("div",ct,[o("strong",dt,p(l.product.title),1),o("span",ut,"x "+p(l.product.quantity),1),o("span",pt,p(l.product.price)+"€",1),o("button",{class:"btn btn-danger",onClick:n[0]||(n[0]=e=>r("removeProductFromCart",l.product._id))}," Remove ")]))}}),ft=v(mt,[["__scopeId","data-v-a0c3602f"]]),_t={class:"d-flex flex-column"},vt=f({__name:"CartProductList",props:{cart:{}},emits:["removeProductFromCart"],setup(u,{emit:t}){const r=t;return(l,n)=>(i(),d("div",_t,[(i(!0),d(g,null,y(l.cart,e=>(i(),C(ft,{product:e,key:e._id,onRemoveProductFromCart:n[0]||(n[0]=a=>r("removeProductFromCart",a))},null,8,["product"]))),128))]))}}),gt={class:"cart-container"},yt={class:"tag"},Ct={key:1},$t={class:"p-20 d-flex flex-column card ml-20"},ht={class:"btn btn-success"},bt=f({__name:"Cart",props:{cart:{}},emits:["removeProductFromCart"],setup(u,{emit:t}){const r=b({open:!1}),l=u,n=$(()=>l.cart.reduce((a,s)=>a+s.price*s.quantity,0)),e=t;return(a,s)=>(i(),d("div",gt,[_(R,{mode:"out-in"},{default:F(()=>[r.open?(i(),d("div",Ct,[_(x,{open:r.open,onClose:s[1]||(s[1]=c=>r.open=!1)},null,8,["open"]),o("div",$t,[s[4]||(s[4]=o("h2",{class:"mb-10"},"Panier",-1)),_(vt,{class:"flex-fill",cart:a.cart,onRemoveProductFromCart:s[2]||(s[2]=c=>e("removeProductFromCart",c))},null,8,["cart"]),o("button",ht,"Commander ("+p(n.value)+"€)",1)])])):(i(),d("div",{key:0,onClick:s[0]||(s[0]=c=>r.open=!r.open),class:"cart-holder d-flex flex-row justify-content-center align-items-center"},[o("span",yt,p(a.cart.length),1),s[3]||(s[3]=o("i",{class:"fa-solid fa-basket-shopping"},null,-1))]))]),_:1})]))}}),Pt=v(bt,[["__scopeId","data-v-b14caa3d"]]),P={search:"",priceRange:[0,1e4],category:"all"};async function kt(u,t){const r=new URLSearchParams;return u.category!=="all"&&r.append("category",u.category),r.append("limit","20"),t!==1&&r.append("skip",(t-1)*20+""),r.append("price",`{"$gte":${u.priceRange[0]}, "$lte":${u.priceRange[1]}}`),await(await fetch(`https://restapi.fr/api/projetproducts?${r}`)).json()}const xt={class:"d-flex flex-column"},Rt=f({__name:"Boutique",setup(u){const t=b({products:[],cart:[],filters:{...P},page:1,isLoading:!0,moreResults:!0});k([()=>t.filters.priceRange,()=>t.filters.category],()=>{t.page=1,t.products=[]}),A(w,M(t,"page")),B(async()=>{t.isLoading=!0;const s=await kt(t.filters,t.page);Array.isArray(s)?(t.products=[...t.products,...s],s.length<20&&(t.moreResults=!1)):t.products=[...t.products,s],t.isLoading=!1});const r=s=>{const c=t.products.find(m=>m._id===s);if(c){const m=t.cart.find(S=>S._id===s);m?m.quantity++:t.cart.push({...c,quantity:1})}},l=s=>{const c=t.cart.find(m=>m._id===s);c&&((c==null?void 0:c.quantity)===1?t.cart=t.cart.filter(m=>m._id!==s):c.quantity--)},n=$(()=>t.cart.length===0),e=$(()=>t.products.filter(s=>!!s.title.toLocaleLowerCase().startsWith(t.filters.search.toLocaleLowerCase()))),a=s=>{s.search!==void 0?t.filters.search=s.search:s.priceRange?t.filters.priceRange=s.priceRange:s.category?t.filters.category=s.category:t.filters={...P}};return(s,c)=>(i(),d("div",xt,[_(it,{onUpdateFilter:a,onAddProductToCart:r,onLoadMore:c[0]||(c[0]=m=>t.page++),"more-results":t.moreResults,products:e.value,filters:t.filters},null,8,["more-results","products","filters"]),n.value?h("",!0):(i(),C(Pt,{key:0,onRemoveProductFromCart:l,cart:t.cart},null,8,["cart"]))]))}});export{Rt as default};
